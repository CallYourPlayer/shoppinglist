<h1>Spesa</h1>
<p>Data: <%= @shopping.date_shopping.strftime("%d/%m/%Y") %></p>
<p>Totale: <span id="shoppingTotal-<%= @shopping.id %>"><%= @shopping.total.round(2) %> </span>€</p>
<div class="button-container">
  <% if can? :update, @shopping %>
   <%= form_with model: @shopping, url: shopping_path(@shopping.id), method: :put do |form| %>
    <%= form.hidden_field :status, value: 'pagato' %>
    <%# <%= form.submit "Pagata", class: "btn btn-warning" %>
    <%= button_tag( :class => "btn btn-warning") do %>
      <i class="fa fa-credit-card"></i> Pagata
    <% end %>
    <% end %>
  <%# <%= link_to 'Pagata', {controller: 'shoppings', action: 'archive', 
            my: {id: @shopping.id}}, 
            :method => :post, 
            class: "btn btn-warning" %>
<%# <%= link_to "Cancella", @shopping, class: 'btn btn-danger', data: { turbo_method: :delete,
    turbo_confirm: "Sei sicuro?"
  } %>
  <% end %>
  <% if can? :destroy, @shopping %>
    <%= button_to "Cancella", @shopping, class: 'btn btn-danger', method: :delete %>
  <% end %>
</div>
<br><br>
<h2>Articoli</h2>
<%= link_to 'Nuovo Articolo', '#new_item_modal', 'data-toggle' => 'modal', class: "btn btn-info" %>
<%# <%= link_to 'Nuovo Articolo', new_shopping_item_path(@shopping.id), class: "btn btn-info" %>
<table class="table table-striped" id="items-<%= @shopping.id %>">
  <thead>
    <tr>
      <th>Articolo</th><th>Quantità</th><th>Prezzo Unitario</th><th>Prezzo Tot.</th><th></th>
    </tr>
  </thead>
  <tbody>

    <%= render @shopping.items %>

  </tbody>
</table>

<%# Bootstrap modal markup. @see: http://getbootstrap.com/javascript/#modals %>
<div class="modal fade" id="new_item_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Crea nuovo articolo</h4>
      </div>
      <div class="modal-body">
        <%# Render the new item form (passing modal => true to enable remote => true) %>
        <%= render 'items/form', modal: true %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>